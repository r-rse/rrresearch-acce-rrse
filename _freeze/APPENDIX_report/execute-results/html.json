{
  "hash": "5372a61e04880d25c1693858e7e11a52",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"`report.qmd`\"\n---\n\n\nThe `report.qmd` Quarto document contains the project report.\n\nYour file report should look a bit like:\n\n\n::: {.cell filename='report.qmd'}\n::: {.cell-output .cell-output-stderr}\n\n````\n---\ntitle: \"Analysis of NEON Woody plant vegetation structure data\"\nsubtitle: \"ACCE DTP course\"\nauthor: \"Anna Krystalli\"\ndate: \"2024-03-19\"\nformat:\n  html:\n    toc: true\n    theme: minty\n    highlight-style: dracula\n    df-print: paged\neditor: visual\nbibliography: data-raw/wood-survey-data-master/references.bib\n---\n\n## Background\n\n![](data-raw/wood-survey-data-master/neon-logo.png){width=\"200\"}\n\nThe [NEON Woody plant vegetation structure dataset](https://data.neonscience.org/data-products/DP1.10098.001) [@DP1.10098.001/provisional] contains **structure measurements, including height, canopy diameter, and stem diameter, as well as mapped position of individual woody plants across the survey area.**\n\nThis data product contains the quality-controlled, native sampling resolution data from in-situ measurements of live and standing dead woody individuals and shrub groups, from all terrestrial NEON sites with qualifying woody vegetation. With some modifications, this protocol adopts guidelines established by the @forestry2012 for measuring tree species. The exact measurements collected per individual depend on growth form, and these measurements are focused on enabling biomass and productivity estimation, estimation of shrub volume and biomass, and calibration / validation of multiple NEON airborne remote-sensing data products.\n\nOur analyses focus on the **relationship between individual stem height and diameter** and how that relationship **varies across growth forms**.\n\n### Data Preparation\n\nData was prepared for analysis by:\n\n-   Compiling all individual raw data files into a single table.\n-   Merging individual data with plot level data and geolocating individuals.\n\nThe data preparation steps are contained in the `data-raw/individuals.R` script.\n\n## Summary statistics\n\nPrepared data were also subset to columns of interest `stem_diameter`, `height` and `growth_form` and records where `growth_form` values were not `\"liana\"` or missing.\n\n```{r}\n#| label: setup\n#| code-fold: true\n#| message: false\n## Setup ----\n# Load libraries\nlibrary(dplyr)\nlibrary(ggplot2)\n# Load data\nindividual <- readr::read_csv(\n  here::here(\"data\", \"individual.csv\")\n) %>%\n  select(stem_diameter, height, growth_form)\n\n## Subset analysis data ----\nanalysis_df <- individual %>%\n  filter(!is.na(growth_form), growth_form != \"liana\")\n\n## Order growth form levels\ngf_levels <- table(analysis_df$growth_form) %>%\n  sort() %>%\n  names()\nanalysis_df <- analysis_df %>%\n  mutate(growth_form = factor(growth_form,\n    levels = gf_levels\n  ))\n```\n\nThe final data set contains a total of **`{r} nrow(analysis_df)`**\n\n```{r}\n#| echo: false\n#| label: tbl-print\nanalysis_df\n```\n\n```{r}\n#| echo: false\n#| label: fig-growth-form-counts\n#| fig-cap: \"Distribution of individual counts across growth forms.\"\n\nanalysis_df %>%\n  ggplot(aes(\n    y = growth_form, colour = growth_form,\n    fill = growth_form\n  )) +\n  geom_bar(alpha = 0.5, show.legend = FALSE)\n\n```\n\n@fig-growth-form-counts shows the distribution of individual counts across growth forms in the dataset.\n\n```{r}\n#| echo: false\n#| label: fig-violin-plots\n#| fig-cap: \"Distribution of log stem_diameter and log height across growth forms\"\nanalysis_df %>%\n  tidyr::pivot_longer(\n    cols = c(stem_diameter, height),\n    names_to = \"var\",\n    values_to = \"value\"\n  ) %>%\n  ggplot(aes(\n    x = log(value), y = growth_form,\n    colour = growth_form, fill = growth_form\n  )) +\n  geom_violin(alpha = 0.5, trim = TRUE, show.legend = FALSE) +\n  geom_boxplot(alpha = 0.7, show.legend = FALSE) +\n  facet_grid(~var) +\n  theme_linedraw()\n```\n\n@fig-violin-plots shows the log distribution of stem diameter and log height across growth forms.\n\n# Analysis\n\n## Modelling overall `stem_diameter` as a function of `height`\n\nInitially we fit a linear model of form `log(stem_diameter)` as a function of `log(height)`\n\n```{r}\nlm_overall <- lm(\n  log(stem_diameter) ~ log(height),\n  analysis_df\n)\n```\n\n```{r}\n#| echo: false\n#| tbl-cap: \"Overall model evaluation\"\n#| label: tbl-overall-glance\nlibrary(gt)\nlm_overall |> \n  broom::glance() |> \n  gt() |>\n  fmt_number(decimals = 2)\n```\n\n```{r}\n#| echo: false\n#| tbl-cap: \"Overall model coefficents\"\n#| label: tbl-overall-tidy\nlibrary(gt)\nlm_overall |> broom::tidy() |> \n  gt() |>\n  fmt_number(decimals = 4) |>\n  tab_style_body(\n    columns = \"p.value\",\n    style = cell_text(weight = \"bold\"),\n    fn = function(x) x < 0.05\n  )\n```\n\n```{r}\n#| echo: false\n#| fig-cap: \"Relationship between stem diameter and height across all data.\"\n#| label: fig-overall-lm\nanalysis_df %>%\n  ggplot(aes(x = log(height), y = log(stem_diameter))) +\n  geom_point(alpha = 0.2) +\n  geom_smooth(method = \"lm\") +\n  xlab(\"Log of height (m)\") +\n  ylab(\"Log of stem diameter (cm)\") +\n  theme_linedraw()\n\n```\n\nSee @fig-overall-lm, @tbl-overall-glance and @tbl-overall-tidy for results.\n\n### Growth form level analysis\n\nWe also fit a model with an interaction term with growth form included.\n\n```{r}\nlm_growth <- lm(\n  log(stem_diameter) ~ log(height) * growth_form,\n  analysis_df\n)\n```\n\n```{r}\n#| echo: false\n#| tbl-cap: \"Growth Form interaction model evaluation\"\n#| label: tbl-growth-glance\nlibrary(gt)\nlm_growth |> broom::glance() |> gt() |>\n  fmt_number(decimals = 2)\n```\n\n```{r}\n#| echo: false\n#| tbl-cap: \"Growth Form interaction model coefficents\"\n#| label: tbl-growth-tidy\nlibrary(gt)\nlm_growth |> broom::tidy() |> gt() |>\n  fmt_number(decimals = 4) |>\n  tab_style_body(\n    columns = \"p.value\",\n    style = cell_text(weight = \"bold\"),\n    fn = function(x) x < 0.05\n  )\n```\n\n```{r}\n#| echo: false\n#| fig-cap: \"Relationship between stem diameter and height across growth forms.\"\n#| label: fig-growth-formlm\nanalysis_df %>%\n  ggplot(aes(x = log(height), y = log(stem_diameter), colour = growth_form)) +\n  geom_point(alpha = 0.1) +\n  geom_smooth(method = \"lm\") +\n  labs(\n    x = \"Log of height (m)\",\n    y = \"Log of stem diameter (cm)\",\n    colour = \"Growth forms\"\n  ) +\n  theme_linedraw()\n```\n\nSee @fig-growth-formlm, @tbl-growth-glance and @tbl-growth-tidy for results.\n\n## Summary\n\nOur results follow findings in the literature e.g @THORNLEY1999195, @CANNELL1984299 and @Haase.\n````\n\n\n:::\n:::\n\n\nand render to something that looks like this:\n\n\n::: {.cell}\n<iframe src=\"https://annakrystalli-personal.quarto.pub/analysis-of-neon-woody-plant-vegetation-structure-data/\" width=\"672\" height=\"400px\" data-external=\"1\"></iframe>\n:::\n",
    "supporting": [
      "APPENDIX_report_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}